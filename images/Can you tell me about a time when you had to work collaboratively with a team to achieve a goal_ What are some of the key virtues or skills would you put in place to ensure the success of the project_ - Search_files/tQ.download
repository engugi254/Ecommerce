var SydneyFullScreenConv;(function(n){function yi(n){var p,w,d,g,nt,it,rt,ft,et,ot,at,yt,pt,ni,yi,ir,rr,fr,er,or,lr,vr,yr,pr,wr,br,kr,dr,gr,nu,tu,ru,fu,eu,ou,su,hu,cu,lu,au,h,vu,du,gu,nf,yu,i,y,pu,wu,bu,tf;if(n===void 0&&(n=null),h=_ge(ur),!h.querySelector("cib-serp")){st=(p=_w._sydConvConfig)===null||p===void 0?void 0:p.usePill;ht=(w=_w._sydConvConfig)===null||w===void 0?void 0:w.enableScrollOut;ct=(d=_w._sydConvConfig)===null||d===void 0?void 0:d.enableSydContext;l=(g=_w._sydConvConfig)===null||g===void 0?void 0:g.enableSydHistory;sr=(nt=_w._sydConvConfig)===null||nt===void 0?void 0:nt.enableSydTigerAns;wt=(it=_w._sydConvConfig)===null||it===void 0?void 0:it.enableSydAjax;ut=(rt=_w._sydConvConfig)===null||rt===void 0?void 0:rt.enableSydCarousel;k=(ft=_w._sydConvConfig)===null||ft===void 0?void 0:ft.moveOnlySydXAnswers;f=(et=_w._sydConvConfig)===null||et===void 0?void 0:et.hideSydFSC;e=(ot=_w._sydConvConfig)===null||ot===void 0?void 0:ot.enableSydOverlay;lt=(at=_w._sydConvConfig)===null||at===void 0?void 0:at.enable1TCibSlot;b=(yt=_w._sydConvConfig)===null||yt===void 0?void 0:yt.enableSydX1T;bt=(pt=_w._sydConvConfig)===null||pt===void 0?void 0:pt.hideSydMic;kt=(ni=_w._sydConvConfig)===null||ni===void 0?void 0:ni.fromNoResults;si=(yi=_w._sydConvConfig)===null||yi===void 0?void 0:yi.codexWinEnableCustomGreeting;hi=(ir=_w._sydConvConfig)===null||ir===void 0?void 0:ir.codexWinGreetingCustomString;ti=(rr=_w._sydConvConfig)===null||rr===void 0?void 0:rr.checkCreatorAnsFor1T;dt=SydFSCHelper.getConfigOrDefault((fr=_w._sydConvConfig)===null||fr===void 0?void 0:fr.enableSydCarouselHistory,!1);hr=SydFSCHelper.getConfigOrDefault((er=_w._sydConvConfig)===null||er===void 0?void 0:er.enableSQMsg,!1);gt=SydFSCHelper.getConfigOrDefault((or=_w._sydConvConfig)===null||or===void 0?void 0:or.enableSemSerpNoCache,!1);ii=SydFSCHelper.getConfigOrDefault((lr=_w._sydConvConfig)===null||lr===void 0?void 0:lr.enableSydStaticAdsLink,!1);var rf=SydFSCHelper.getConfigOrDefault((vr=_w._sydConvConfig)===null||vr===void 0?void 0:vr.hideSydReconnect,!1),uf=(yr=_w._sydConvConfig)===null||yr===void 0?void 0:yr.enableDlBing,ff=(pr=_w._sydConvConfig)===null||pr===void 0?void 0:pr.disableSydGhosting,ef=SydFSCHelper.getConfigOrDefault((wr=_w._sydConvConfig)===null||wr===void 0?void 0:wr.disableCibNotificationStyleUpdate,!1),sf=_w._sydCachedString,ku=_w._sydAddOptionsSet;if(_G[SydFSCHelper.SYD_MODE]="serp",_G[SydFSCHelper.SYD_PREV_MODE]="",ri=SydFSCHelper.getConfigOrDefault((br=_w._sydConvConfig)===null||br===void 0?void 0:br.disableTabletScroll,!1),ui=SydFSCHelper.getConfigOrDefault((kr=_w._sydConvConfig)===null||kr===void 0?void 0:kr.disableTabletScrollOut,!1),c=SydFSCHelper.getConfigOrDefault((dr=_w._sydConvConfig)===null||dr===void 0?void 0:dr.disableFocusedTabletScrollOut,!1),fi=SydFSCHelper.getConfigOrDefault((gr=_w._sydConvConfig)===null||gr===void 0?void 0:gr.disableTouchDesktopScroll,!1),ei=SydFSCHelper.getConfigOrDefault((nu=_w._sydConvConfig)===null||nu===void 0?void 0:nu.disableDesktopScroll,!1),oi=SydFSCHelper.getConfigOrDefault((tu=_w._sydConvConfig)===null||tu===void 0?void 0:tu.enableConvModeSwitchAjax,!1),ai=SydFSCHelper.getConfigOrDefault((ru=_w._sydConvConfig)===null||ru===void 0?void 0:ru.enableCssSplitConvModeOnClick,0),vt=SydFSCHelper.getConfigOrDefault((fu=_w._sydConvConfig)===null||fu===void 0?void 0:fu.enableWelcomeScreenV2,!1),vi=SydFSCHelper.getConfigOrDefault((eu=_w._sydConvConfig)===null||eu===void 0?void 0:eu.enable2TQueryConfigsOnSerpLoad,!1),a=_d.createElement("slot"),a.setAttribute("name","firstAnswer"),a.setAttribute("slot","firstAns"),v=_d.createElement("slot"),v.setAttribute("name","firstAns"),r=((ou=_d.getElementsByClassName("b_top"))===null||ou===void 0?void 0:ou.length)>0?_d.getElementsByClassName("b_top")[0]:null,tt=!r?!1:r.getElementsByClassName("b_wpt_ch").length>0||r.getElementsByClassName("qna-sydney").length>0,vu=_ge("b_header"),h&&vu&&sj_b.insertBefore(h,vu),t=_d.createElement("div"),t===null||t===void 0?void 0:t.setAttribute("slot","firstAnswer"),t===null||t===void 0?void 0:t.setAttribute("id","sydFirstAnswer"),t.style.maxWidth="648px",SydFSCHelper.setConfigs(n),SydFSCHelper.setEventListeners(),SydFSCHelper.setSydFSCEligibleState(!0),u=CIB.insertAt(h),vt&&(SydWelcomeScreen===null||SydWelcomeScreen===void 0?void 0:SydWelcomeScreen.setContent(u)),du=SydFSCHelper.getConfigOrDefault((su=_w._sydConvConfig)===null||su===void 0?void 0:su.isCompliantSydneyEndpointEnabled,!1),du&&(MsbSydneyHelper.addTenantLogoToHeader(),MsbSydneyHelper.disableTones()),gu=SydFSCHelper.getConfigOrDefault((hu=_w._sydConvConfig)===null||hu===void 0?void 0:hu.useAccountLinkingForConversationLimitUpsell,!1),gu&&(CIB.config.bing.signIn.query.action="acclink",CIB.config.bing.signIn.query.crea="MY04B",CIB.config.bing.signIn.query.pn="AccountLinking_Chat",CIB.config.bing.signIn.query.publ="BingIP"),u.setAttribute("alignment","left"),uf&&CIB.config.sydney.request.optionsSets.push("dlbing"),ku&&CIB.config.sydney.request.optionsSets.push(ku),kt)SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim();else{CIB.config.greeting.shouldSendBotGreeting=SydFSCHelper.shouldForceSendBotGreeting;oi||(sj_evt.bind("ajax.unload",function(){SydFSCHelper.shouldResetBotGreeting=!1}),sj_evt.bind("ajax.load",function(){SydFSCHelper.shouldResetBotGreeting=!0}));CIB.onConversationRequestStateChange(function(n){n||CIB.config.greeting.shouldSendBotGreeting||!SydFSCHelper.shouldResetBotGreeting||(CIB.config.greeting.shouldSendBotGreeting=!0)})}SydFSCHelper.setTestMocks();dt&&(nf=new URLSearchParams(_w.location.search),yu=nf.get("convid"),yu&&uu(yu));i=(cu=_d.querySelector("cib-serp"))===null||cu===void 0?void 0:cu.shadowRoot;y=i===null||i===void 0?void 0:i.querySelector("cib-conversation");y&&y.shadowRoot&&(o=y.shadowRoot.querySelector(".scroller"),pu=sj_ce("style"),rf&&(pu.textContent="\n                cib-notification-container {\n                    display: none;\n                }\n            "),y.shadowRoot.appendChild(pu));ff&&(wu=(au=(lu=i===null||i===void 0?void 0:i.querySelector("cib-action-bar"))===null||lu===void 0?void 0:lu.shadowRoot)===null||au===void 0?void 0:au.querySelector(".autosuggest-text"),wu&&(wu.style.display="none"));bu="ontouchstart"in window||!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0;tf=c&&(ci||li||ClientObserver.getBrowserWidth()<780);bu&&Log.Log("ClientInst","Codex","TouchD");e||ri||ei||tf||bu&&fi||(sj_be(_w,"mousewheel",bi),sj_be(_w,"touchstart",ki),sj_be(_w,"touchmove",di),sj_be(_w,"touchend",gi),c&&(sj_be(_w,"keydown",nr),sj_be(_w,"resize",tr)));SydFSCHelper.triggerShareFlow();pi();sj_evt.bind("ajax.load",pi);l&&(SydFSCHelper.setupHistory(),SydFSCHelper.checkInitialState());ar();e&&iu();SydFSCHelper.triggerClarity();CIB.onResetConversation(function(){SydFSCHelper.shouldMove1TAnswers(b,s)&&wi()});CIB.onModeChanged(function(n){var t,i=SydFSCHelper.getConfigOrDefault((t=_w._sydConvConfig)===null||t===void 0?void 0:t.disResetTT,!1);i&&n=="conversation"&&cr();sj_evt.fire("onModeChanged")});if(CIB.onMobileUpsellPopupShown)CIB.onMobileUpsellPopupShown(function(){var n={convId:CIB.manager.conversation.id};SydFSCHelper.SydLog("SystemEvent","MobileUpsell","MobileUpsellPopupShown",n);SydFSCHelper.createRequest("sydchat/writeConvId",JSON.stringify(n))});si&&SydFSCHelper.processCachedResponseUsingCIB(JSON.parse(hi));SydFSCHelper.updateToneFontSize()}}function cr(){var n,t,r=(t=(n=u===null||u===void 0?void 0:u.shadowRoot)===null||n===void 0?void 0:n.querySelector("cib-action-bar"))===null||t===void 0?void 0:t.shadowRoot,i;r&&(i=sj_ce("style"),i.textContent="\n                    cib-tooltip {\n                        display: none !important;\n                    }\n                ",r.appendChild(i))}function pi(){sj_evt.bind("hideSydFSC",function(n){var c,t,i,y,u,o,r,h;if(!rt){if(rt=!0,Log.Log("ClientInst","Codex","LeaveConversationMode"),f||Lib.CssClass.remove(sj_b,g),c=_ge("sb_form"),c&&Lib.CssClass.contains(c,"hassbi")&&Lib.CssClass.remove(c,"hassbi"),CIB.hideConversation(),f||e||(Lib.CssClass.add(_d.documentElement,"b_delayOvflw"),SydFSCHelper.shouldMove1TAnswers(b,s)&&wi(),t=_ge("b-scopeListItem-web"),t&&t.children.length>0&&(t.parentElement.removeAttribute("role"),t.children[0].setAttribute("aria-current","page"),t.children[0].removeAttribute("aria-selected"),t.children[0].removeAttribute("role"),Lib.CssClass.add(t,"b_active"),_ge("b_skip_to_content").setAttribute("tabindex","0")),i=_ge("b-scopeListItem-conv"),i&&i.children.length>0&&(i.children[0].removeAttribute("role"),i.children[0].removeAttribute("aria-selected"),i.children[0].setAttribute("aria-current","false"),Lib.CssClass.remove(i,"b_active"))),_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],l&&(y=n&&n.length>1?n[1]:!1,y||SydFSCHelper.pushSydHistory(!1))),_G[SydFSCHelper.SYD_MODE]="serp",ut){if(u=_ge("b_pole"),!u){for(u=sj_ce("div","b_pole"),o=_d.querySelector("main"),r=_ge("b_results");r&&o&&r.parentElement!=o;)r=r.parentElement;o&&r&&o.insertBefore(u,r)}SydFSCHelper.addCarousel(u)}else if(wt&&(h=CIB.vm.conversation.model.messages.filter(function(n){return n.type==="meta"&&n.text!="Generating answers for you..."||n.type==="text"&&n.author==="user"}),h&&h.length>0)){var a=h[h.length-1].text.split("`"),v=a.length==1?a[0]:a.length==3?a[1]:"",p=_ge("sb_form_go"),w=_ge("sb_form_q");_w.sj_isAjax&&v&&w.value.toLowerCase()!=v.toLowerCase()&&p&&(w.value=v,SydFSCHelper.lastQuery=v,p.click())}rt=!1}});sb_st(function(){sj_evt.bind("showSydFSC",kr,!0)},0);sj_evt.bind("onModeChanged",function(){});sj_evt.fire("convInit:done")}function lr(){var n;r=((n=_d.getElementsByClassName("b_top"))===null||n===void 0?void 0:n.length)>0?_d.getElementsByClassName("b_top")[0]:null;at=sj_b.querySelector("#b_sydTigerCont")!=null;tt=!!r&&r.querySelector("#sydwrap_wrapper")!=null;k&&(i=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat .b_wpt_chat"),i&&(Lib.CssClass.add(i,yt),ni=i.querySelector(".b_wpt_creator_content")!=null))}function ar(){var n=_ge("id_hbfo");sj_be(n,"click",function(n){var r=n.target,t,i;_G[SydFSCHelper.SYD_MODE]=="conversation"&&r&&(t=vr(r),t&&t.target!="_blank"&&(i="",t.href.indexOf("/profile/")>=0?i="profile":t.href.indexOf("/account/")>=0&&(i="account"),SydFSCHelper.LogIntEvent("ConversationViewExit","Conversation",{source:"ClickMenu",target:i})))})}function vr(n){while(n!=null){if(n.tagName=="A"&&Lib.CssClass.contains(n,"hb_section"))return n;n=n.parentElement}return null}function et(n,t,i){i===void 0&&(i=!1);t&&n&&(i?n.prepend(t):n.appendChild(t))}function yr(n){var u,f,e,o,s,h;if(!st){et(_ge("b_sydtoporpole"),n);return}var l=_d.querySelector("cib-serp"),i=(f=(u=_d.querySelector("cib-serp"))===null||u===void 0?void 0:u.shadowRoot)===null||f===void 0?void 0:f.querySelector("cib-conversation"),r=(o=(e=i===null||i===void 0?void 0:i.shadowRoot)===null||e===void 0?void 0:e.querySelector(".scroller"))===null||o===void 0?void 0:o.querySelector(".main cib-welcome-container"),c=(h=(s=i===null||i===void 0?void 0:i.shadowRoot)===null||s===void 0?void 0:s.querySelector(".scroller"))===null||h===void 0?void 0:h.querySelector(".main");i===null||i===void 0?void 0:i.appendChild(a);r?r===null||r===void 0?void 0:r.after(v):c===null||c===void 0?void 0:c.prepend(v);t===null||t===void 0?void 0:t.appendChild(n);lt;et(l,t)}function pr(){if(lr(),k){if(!i||ti&&ni)return;(s||tt&&!at)&&sb_st(function(){yr(i)},or)}}function wi(){if(k){if(!i)return;var n=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat");n&&!n.contains(i)&&(Lib.CssClass.remove(i,yt),et(n,i,!0))}}function wr(){var n=new URLSearchParams(_w.location.search),t=n.get("sendquery");return t==="1"}function br(){var n=document.getElementById("conv-css-link");n.setAttribute("rel","stylesheet")}function kr(n){var v,y,p,w,k,h,c,a,u,t,i,r,o,rt;if(!it){it=!0;SydFSCHelper.updateResponseToneAfterSerp();CIB.config.features.enableAds=!0;gt&&(k=CIB.config.sydney.request.optionsSets.indexOf("nocacheread"),k>=0&&CIB.config.sydney.request.optionsSets.splice(k,1));ai&&br();h=_ge("b_header");h&&Lib.CssClass.contains(h,ot)&&(Lib.CssClass.remove(h,ot),SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ShowConv"}));ut&&SydFSCHelper.removeQueries();c=n&&n.length>1?n[1]:null;a=n&&n.length>2?n[2]:null;s=n&&n.length>3?n[3]==er:!1;var d=n&&n.length>5?n[5]:null,ft=n&&n.length>6?n[6]:!1,nt=n&&n.length>7?n[7]:!1;if(f||e||(_w.scrollY>0&&_w.scrollTo(0,0),Lib.CssClass.add(_d.documentElement,"b_disOvflw"),Lib.CssClass.remove(_d.documentElement,"b_delayOvflw")),f||Lib.CssClass.add(sj_b,g),SydFSCHelper.shouldMove1TAnswers(b,s,c)&&pr(),c&&SydFSCHelper.sendFirstQuery(c.toLowerCase().trim(),a,d,nt||wr()),CIB.showConversation(),ft&&(u=[],d&&u.push({author:"user",text:d}),a&&u.push({author:"bot",text:a}),ct&&u.length!=0&&CIB.registerContext(u),CIB.toggleSpeechEnabled(),CIB.triggerMic()),!f&&!e&&(t=_ge("b-scopeListItem-web"),t&&t.children.length>0&&(t.parentElement.setAttribute("role","tablist"),t.children[0].setAttribute("aria-current","false"),t.children[0].setAttribute("aria-selected","false"),t.children[0].setAttribute("role","tab"),Lib.CssClass.remove(t,"b_active")),i=_ge("b-scopeListItem-conv"),i&&i.children.length>0&&(i.children[0].setAttribute("aria-current","page"),i.children[0].setAttribute("role","tab"),i.children[0].setAttribute("aria-selected","true"),Lib.CssClass.add(i,"b_active"),_ge("b_skip_to_content").setAttribute("tabindex","-1")),r=_d.querySelector(".b_sydConvMode"),o=(w=(p=(y=(v=r===null||r===void 0?void 0:r.querySelector("cib-serp"))===null||v===void 0?void 0:v.shadowRoot)===null||y===void 0?void 0:y.querySelector("cib-action-bar"))===null||p===void 0?void 0:p.shadowRoot)===null||w===void 0?void 0:w.querySelector(".input-container .text-input textarea"),o&&!nt&&o.focus(),r&&o&&nt)){sj_be(r,"keyup",tt);function tt(n){(n.code=="Tab"||n.keyCode==9||n.key=="Tab")&&o.focus();r.removeEventListener("keyup",tt)}}_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],l&&(rt=n&&n.length>4?n[4]:!1,rt||SydFSCHelper.pushSydHistory(!0)));vi||dr();_G[SydFSCHelper.SYD_MODE]="conversation";it=!1}}function dr(){var n=ClientObserver.getBrowserWidth(),t=ClientObserver.getBrowserHeight();SydFSCHelper.set2TQueryConfigs(n,t,ii)}function bi(n){var t=0;n||(n=window.event);n.wheelDelta?t=n.wheelDelta/60:n.detail&&(t=-n.detail/2);rr(t,nt)}function ki(n){ft=n.changedTouches[0].clientY;d=n.touches&&n.touches.length>1?!0:!1}function di(n){var t=n.changedTouches[0].clientY-ft;rr(t,fr,!0)}function gi(n){h=0;y=!1;p=!1;ft=0;d=n.touches&&n.touches.length!==0}function nr(){ci=!0;c&&(ir(),sj_ue(_w,"keydown",nr))}function tr(){li=!0;c&&(ir(),sj_ue(_w,"resize",tr))}function ir(){sj_ue(_w,"mousewheel",bi);sj_ue(_w,"touchstart",ki);sj_ue(_w,"touchmove",di);sj_ue(_w,"touchend",gi)}function gr(){var n=_ge("b_sydConvCont");n&&Lib.CssClass.contains(document.body,"b_sydConvMode")&&Lib.CssClass.add(_ge("b_content"),"b_hide")}function nu(){var n=_ge("b_sydConvCont");n&&Lib.CssClass.contains(document.body,"b_sydConvMode")&&Lib.CssClass.remove(_ge("b_content"),"b_hide")}function rr(n,t,i){i===void 0&&(i=!1);sb_ct(pt);y||(w=Lib.CssClass.contains(sj_b,g),p=w?tu():_w.scrollY==0);y=!0;p&&(h+=n);i||(pt=sb_st(function(){h=0;y=!1;p=!1},150));!w&&h>t&&_G[SydFSCHelper.SYD_MODE]!="conversation"&&!d?(SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ScrollUp"}),SydFSCHelper.triggerSydFSCQueryWithContext()):ht&&w&&h<-1*t&&_G[SydFSCHelper.SYD_MODE]=="conversation"&&!ui&&!d&&(SydFSCHelper.LogIntEvent("ConversationViewExit","Scope",{source:"ScrollDown",target:_G[SydFSCHelper.SYD_PREV_MODE]}),sj_evt.fire("hideSydFSC"),sb_st(function(){_w.scrollTo(0,0)},1))}function tu(){return!o?!1:Math.abs(o.scrollTop-(o.scrollHeight-o.offsetHeight))<1}function iu(){var t,i,r,e=_ge("b_sydOvrClose"),n,u,f;e&&sj_be(e,"click",function(){sj_evt.fire("hideSydFSC")});n=(r=(i=(t=_d.querySelector("#b_sydConvCont cib-serp"))===null||t===void 0?void 0:t.shadowRoot)===null||i===void 0?void 0:i.querySelector("cib-action-bar"))===null||r===void 0?void 0:r.shadowRoot;u=n===null||n===void 0?void 0:n.querySelector(".outside-left-container");u&&(u.style.display="none");bt&&n&&(f=sj_ce("style"),f.textContent="\n                .control.microphone {\n                    display: none;\n                }\n            ",n.appendChild(f))}function ru(n,t){var i,r;n===void 0&&(n=null);t===void 0&&(t=nt);r=(i=_w._sydPayWallConfig)===null||i===void 0?void 0:i.loadSydneyConvResWithPayWall;r?sj_evt.bind("waitlistUpdate:eligible",yi,!0):yi(n);nt=t}function uu(n){CIB.loadConversation(n);SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim()}var g="b_sydConvMode",ot="b_sydShowConv",ur="b_sydConvCont",nt=10,fr=100,st,ht,ct,l,lt=!1,r,tt,i=null,at=!1,u,vt,o,t,a,v,er="SYDX_WRAPPER",s=!1,yt="b_sydxwrappedanswer",or=1e3,it=!1,rt=!1,h=0,pt,y=!1,p=!1,w=!1,sr=!1,b=!1,wt=!1,ut=!1,f=!1,e=!1,ft,k=!1,bt=!1,kt=!1,dt=!1,hr=!1,gt=!1,ni=!1,ti=!1,ii=!1,ri=!1,ui=!1,c=!1,fi=!1,ei=!1,oi=!1,si=!1,hi="",ci=!1,li=!1,d=!1,ai,vi=!1;(typeof sj_b=="undefined"||sj_b==null)&&(window.sj_b=document.body);n.initWithWaitlistUpdate=ru;sj_evt.fire("sydFSC.init");sj_be(_w,"beforeprint",gr);sj_be(_w,"afterprint",nu)})(SydneyFullScreenConv||(SydneyFullScreenConv={}))